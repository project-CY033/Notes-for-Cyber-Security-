

# Network System Vulnerability Assessment - Unit 2: Vulnerabilities

This document provides a detailed explanation of the vulnerabilities listed under Unit 2, based on the OWASP Top 10 and related resources. Each vulnerability is explained with its description, prevention strategies, and examples where applicable.

## Key Points
- **Injection vulnerabilities**, like SQL injection, allow attackers to manipulate data or execute malicious code, but secure coding practices can mitigate risks.
- **Broken authentication** and **session management** issues may enable unauthorized access, though multi-factor authentication reduces this threat.
- **Cross-Site Scripting (XSS)**, a type of injection, can hijack user sessions, but input validation and output encoding offer strong defenses.
- **Insecure Direct Object Reference** and **Missing Function Level Access Control** expose sensitive data or functions, preventable with robust access controls.
- **Security Misconfiguration** and **Sensitive Data Exposure** are common but avoidable with proper configuration and encryption.
- **CSRF**, **vulnerable components**, and **unvalidated redirects** pose risks, but tokens, updates, and URL validation can minimize their impact.

## Injection
Injection vulnerabilities occur when untrusted data is sent to an interpreter, potentially allowing attackers to access or modify data or execute harmful code. Common types include SQL injection and command injection. To prevent these, use parameterized queries, validate inputs, and employ safe APIs. For example, a vulnerable SQL query like `SELECT * FROM users WHERE id = 'user_input'` could be exploited by injecting malicious code.

## Broken Authentication and Session Management
This vulnerability arises from weak authentication or session management, enabling attackers to steal credentials or hijack sessions. Implementing multi-factor authentication, secure password storage, and proper session handling can mitigate risks. For instance, storing session IDs in URLs can allow attackers to intercept them easily.

## Cross-Site Scripting (XSS)
XSS, a subset of injection, involves injecting malicious scripts into web pages viewed by users, potentially leading to session theft or malware distribution. Prevent it by validating inputs, encoding outputs, and using Content Security Policy (CSP). An example is a web form that displays unfiltered user input, allowing script execution.

## Insecure Direct Object Reference
This occurs when applications expose internal object references (e.g., file names or database keys) without access control, allowing unauthorized access. Use indirect references and enforce access checks. For example, an attacker might access `file=secret.txt` if the application doesn’t verify permissions.

## Security Misconfiguration
Improperly configured security settings, such as default passwords or enabled unnecessary features, can expose applications to attacks. Regular configuration reviews and disabling unused features help. An example is a server with directory listing enabled, revealing sensitive files.

## Sensitive Data Exposure
Failing to protect sensitive data, like credit card numbers, can lead to breaches. Encrypt data in transit and at rest, and limit storage of sensitive information. For instance, storing unencrypted passwords in a database is a common mistake.

## Missing Function Level Access Control
This vulnerability allows attackers to access restricted functions by manipulating inputs, such as URLs. Implement function-level access controls and role-based permissions. An example is accessing an admin page by changing a URL parameter like `role=admin`.

## Cross-Site Request Forgery (CSRF)
CSRF tricks users into performing unintended actions on a trusted site using their credentials. Use CSRF tokens and SameSite cookies to prevent this. For example, a malicious link could trigger a fund transfer if the site lacks proper defenses.

## Using Components With Known Vulnerabilities
Using outdated or vulnerable software components can expose applications to known exploits. Regularly update components and monitor vulnerability databases. An example is using an old library version with a published exploit.

## Unvalidated Redirects and Forwards
This vulnerability allows attackers to redirect users to malicious sites, often for phishing. Validate redirect URLs against a trusted list and avoid user-controlled redirects. For example, a login page redirecting to a user-supplied URL could lead to a phishing site.

---
---
---
---

# Detailed Explanation of Unit 2 Vulnerabilities

This section provides an in-depth exploration of the vulnerabilities listed under Unit 2, aligned with the OWASP Top 10:2021 and related resources. Each vulnerability is detailed with its description, causes, prevention strategies, examples, and relevant OWASP mappings, ensuring a thorough understanding for developers, security professionals, and stakeholders.

## 1. Injection

### Description
Injection vulnerabilities occur when untrusted data is sent to an interpreter as part of a command or query, allowing attackers to manipulate the application’s behavior. This can lead to unauthorized data access, data modification, or execution of arbitrary code. Common injection types include SQL Injection, NoSQL Injection, OS Command Injection, LDAP Injection, and Expression Language (EL) Injection. According to OWASP Top 10:2021, injection is ranked A03:2021, with a 94% testing coverage and an average incidence rate of 3.37% across applications.

### Causes
- Lack of input validation or sanitization.
- Dynamic queries without context-aware escaping.
- Direct use of user-supplied data in interpreter commands.

### Prevention
- **Parameterized Queries**: Use prepared statements or parameterized interfaces to separate data from code.
- **Input Validation**: Implement positive server-side validation to ensure data conforms to expected formats.
- **Escaping**: Escape special characters in dynamic queries if parameterization is not possible.
- **SQL Controls**: Use LIMIT and other controls to prevent mass data disclosure.
- **Safe APIs**: Leverage APIs that avoid direct interpreter interaction, such as Object-Relational Mapping (ORM) frameworks.

### Example
A vulnerable SQL query in a web application:
```sql
String query = "SELECT * FROM accounts WHERE custID='" + request.getParameter("id") + "'";
```
An attacker could input `' UNION SELECT * FROM sensitive_data;--`, retrieving unauthorized data. A secure version would use:
```sql
PreparedStatement stmt = connection.prepareStatement("SELECT * FROM accounts WHERE custID = ?");
stmt.setString(1, request.getParameter("id"));
```

### OWASP Mapping
- **OWASP Top 10:2021**: A03:2021-Injection
- **Common Weakness Enumerations (CWEs)**: Includes CWE-89 (SQL Injection), CWE-77 (Command Injection), and 33 others.

## 2. Broken Authentication and Session Management

### Description
Broken authentication and session management vulnerabilities occur when authentication mechanisms or session handling are improperly implemented, allowing attackers to compromise credentials, session tokens, or exploit flaws to impersonate users. This is covered under A07:2021-Identification and Authentication Failures in OWASP Top 10:2021, with a maximum incidence rate of 14.84% and 132,195 occurrences.

### Causes
- Weak password policies or storage (e.g., plain text or weak hashing).
- Exposure of session IDs in URLs or logs.
- Insufficient session expiration or invalidation.
- Lack of multi-factor authentication (MFA).

### Prevention
- **Multi-Factor Authentication**: Require MFA to add an extra layer of security.
- **Secure Password Storage**: Use strong hashing algorithms like bcrypt or Argon2.
- **Session Management**: Generate random session IDs, invalidate sessions after logout or inactivity, and avoid URL-based session IDs.
- **Limit Login Attempts**: Implement lockout mechanisms to prevent brute force attacks.
- **Credential Recovery**: Harden recovery processes to avoid account enumeration.

### Example
An application stores session IDs in URLs:
```http
http://example.com/app?sessionID=abc123
```
An attacker could intercept this ID to hijack the session. A secure approach uses cookies with the `HttpOnly` and `Secure` flags:
```http
Set-Cookie: sessionID=abc123; HttpOnly; Secure
```

### OWASP Mapping
- **OWASP Top 10:2021**: A07:2021-Identification and Authentication Failures
- **CWEs**: Includes CWE-287 (Improper Authentication), CWE-384 (Session Fixation), and 22 others.

## 3. Cross-Site Scripting (XSS)

### Description
Cross-Site Scripting (XSS) is a subset of injection vulnerabilities where attackers inject malicious scripts into web pages viewed by other users. This can lead to session hijacking, defacement, or malware distribution. XSS is included in A03:2021-Injection, with specific CWEs like CWE-79 (Improper Neutralization of Input During Web Page Generation).

### Causes
- Failure to validate or sanitize user inputs.
- Lack of output encoding when rendering user data.
- Insecure handling of dynamic content in web pages.

### Prevention
- **Input Validation**: Ensure inputs conform to expected formats.
- **Output Encoding**: Encode data before rendering to neutralize scripts (e.g., convert `<` to `&lt;`).
- **Content Security Policy (CSP)**: Restrict executable scripts to trusted sources.
- **Secure Frameworks**: Use frameworks that automatically escape outputs, like React or Angular.

### Example
A vulnerable web form displays user input directly:
```html
<div>Welcome, <script>alert('XSS')</script></div>
```
An attacker could inject a script to steal cookies. A secure version encodes the input:
```html
<div>Welcome, &lt;script&gt;alert(&#39;XSS&#39;)&lt;/script&gt;</div>
```

### OWASP Mapping
- **OWASP Top 10:2021**: A03:2021-Injection
- **CWEs**: Includes CWE-79 (Cross-Site Scripting), CWE-80 (Basic XSS).

## 4. Insecure Direct Object Reference

### Description
Insecure Direct Object Reference (IDOR) occurs when an application exposes internal object references (e.g., file names, database keys) without enforcing access controls, allowing attackers to access unauthorized resources. This is part of A01:2021-Broken Access Control, with a maximum incidence rate of 55.97% and 318,487 occurrences.

### Causes
- Direct use of user-supplied identifiers without validation.
- Lack of access control checks on resource access.
- Predictable or sequential identifiers.

### Prevention
- **Access Control Checks**: Verify user permissions for every object access.
- **Indirect References**: Use mapped identifiers (e.g., UUIDs) instead of direct references.
- **Input Validation**: Ensure user inputs are valid and authorized.

### Example
A URL like:
```http
http://example.com/app/download?file=secret.txt
```
If unchecked, an attacker could access unauthorized files by changing the `file` parameter. A secure approach uses indirect references:
```http
http://example.com/app/download?id=uuid123
```

### OWASP Mapping
- **OWASP Top 10:2021**: A01:2021-Broken Access Control
- **CWEs**: Includes CWE-639 (Authorization Bypass Through User-Controlled Key).

## 5. Security Misconfiguration

### Description
Security misconfiguration vulnerabilities arise from improperly configured security settings, such as default accounts, unnecessary features, or missing security headers. This is A05:2021-Security Misconfiguration in OWASP Top 10:2021, with 90% testing coverage and 208,387 occurrences.

### Causes
- Default configurations left unchanged.
- Enabled unnecessary features or services.
- Missing security headers or improper permissions.

### Prevention
- **Secure Installation**: Use repeatable hardening processes to configure systems.
- **Minimal Platform**: Disable unused features, accounts, and documentation.
- **Regular Reviews**: Audit configurations and update as needed.
- **Security Headers**: Implement headers like X-Frame-Options and Strict-Transport-Security.

### Example
A web server with directory listing enabled:
```http
http://example.com/app/secret/
```
This could expose sensitive files. Disabling directory listing prevents this.

### OWASP Mapping
- **OWASP Top 10:2021**: A05:2021-Security Misconfiguration
- **CWEs**: Includes CWE-16 (Configuration), CWE-611 (Improper Restriction of XML External Entity Reference).

## 6. Sensitive Data Exposure

### Description
Sensitive data exposure occurs when sensitive information, such as passwords, credit card numbers, or personal data, is not adequately protected, either in transit or at rest. This is covered under A02:2021-Cryptographic Failures, with a maximum incidence rate of 46.44% and 233,788 occurrences.

### Causes
- Lack of encryption for data in transit or at rest.
- Weak or outdated cryptographic algorithms.
- Improper key management or storage.

### Prevention
- **Encryption**: Use TLS for data in transit and strong encryption (e.g., AES-256) for data at rest.
- **Access Controls**: Restrict access to sensitive data based on need.
- **Data Minimization**: Avoid storing sensitive data unless necessary.
- **Secure Key Management**: Store keys securely and rotate regularly.

### Example
Storing unencrypted credit card numbers:
```sql
INSERT INTO users (credit_card) VALUES ('4111111111111111');
```
A secure approach encrypts the data:
```sql
INSERT INTO users (credit_card) VALUES (ENCRYPT('4111111111111111', key));
```

### OWASP Mapping
- **OWASP Top 10:2021**: A02:2021-Cryptographic Failures
- **CWEs**: Includes CWE-327 (Broken or Risky Crypto Algorithm), CWE-331 (Insufficient Entropy).

## 7. Missing Function Level Access Control

### Description
Missing function-level access control allows attackers to access restricted functions or data by manipulating inputs, such as URLs, bypassing access control checks. This is part of A01:2021-Broken Access Control.

### Causes
- Lack of server-side access control checks for functions.
- Reliance on client-side controls that can be bypassed.
- Inconsistent permission enforcement.

### Prevention
- **Function-Level Checks**: Verify user permissions for every function access.
- **Role-Based Access Control (RBAC)**: Define and enforce roles for access.
- **Server-Side Validation**: Ensure all access controls are enforced server-side.

### Example
An application allows access to an admin function via:
```http
http://example.com/app/admin_getappInfo
```
Without checks, an attacker could access it by guessing the URL. A secure approach verifies user roles server-side.

### OWASP Mapping
- **OWASP Top 10:2021**: A01:2021-Broken Access Control
- **CWEs**: Includes CWE-862 (Missing Authorization), CWE-863 (Incorrect Authorization).

## 8. Cross-Site Request Forgery (CSRF)

### Description
Cross-Site Request Forgery (CSRF) attacks trick authenticated users into performing unintended actions on a trusted site by exploiting their session cookies. This can lead to actions like fund transfers or account changes. While not in the OWASP Top 10:2021, it’s a well-documented vulnerability addressed in OWASP’s Cheat Sheet Series.

### Causes
- Lack of CSRF tokens for state-changing requests.
- Automatic inclusion of session cookies in browser requests.
- Insufficient origin verification.

### Prevention
- **CSRF Tokens**: Include unique, unpredictable tokens in state-changing requests.
- **SameSite Cookies**: Use `SameSite=Strict` or `Lax` to limit cookie inclusion in cross-site requests.
- **Origin Verification**: Check Origin or Referer headers to ensure requests come from trusted sources.
- **Custom Headers**: Use custom headers for AJAX requests to trigger CORS preflight checks.

### Example
A malicious HTML page:
```html
<img src="http://example.com/transfer?amount=1000&to=attacker" />
```
If the victim is logged in, the browser sends the request with their cookies. A CSRF token in the form prevents this:
```html
<form action="/transfer" method="post">
    <input type="hidden" name="CSRFToken" value="random_token">
</form>
```

### OWASP Mapping
- **OWASP Resource**: Cross-Site Request Forgery Prevention Cheat Sheet
- **CWEs**: CWE-352 (Cross-Site Request Forgery).

## 9. Using Components With Known Vulnerabilities

### Description
This vulnerability occurs when applications use outdated or vulnerable components, such as libraries or frameworks, exposing them to known exploits. It’s A06:2021-Vulnerable and Outdated Components in OWASP Top 10:2021, with an average incidence rate of 8.77% and 30,457 occurrences.

### Causes
- Failure to update components to patched versions.
- Lack of visibility into component versions and dependencies.
- Use of unsupported or end-of-life software.

### Prevention
- **Regular Updates**: Update components to the latest secure versions.
- **Dependency Scanning**: Use tools like OWASP Dependency-Check to identify vulnerable components.
- **Vulnerability Monitoring**: Subscribe to CVE and NVD alerts for used components.
- **Official Sources**: Obtain components from trusted, secure sources.

### Example
Using an outdated Struts library:
```xml
<dependency>
    <groupId>org.apache.struts</groupId>
    <artifactId>struts2-core</artifactId>
    <version>2.3.32</version>
</dependency>
```
This version is vulnerable to CVE-2017-5638, allowing remote code execution. Updating to a patched version mitigates the risk.

### OWASP Mapping
- **OWASP Top 10:2021**: A06:2021-Vulnerable and Outdated Components
- **CWEs**: Includes CWE-1104 (Use of Unmaintained Third Party Components).

## 10. Invalidated Redirects and Forwards

### Description
Unvalidated redirects and forwards (often called “Invalidated” in error) occur when a web application accepts untrusted input for redirection, allowing attackers to redirect users to malicious sites for phishing or to bypass access controls. This is addressed in OWASP’s Unvalidated Redirects and Forwards Cheat Sheet.

### Causes
- Direct use of user-supplied URLs for redirects or forwards.
- Lack of validation against a trusted URL list.
- Vulnerable redirect mechanisms in frameworks.

### Prevention
- **Avoid Redirects**: Minimize use of redirects and forwards.
- **URL Validation**: Validate redirect URLs against a whitelist of trusted domains.
- **Indirect References**: Map short IDs to URLs server-side.
- **User Notification**: Inform users before redirecting to external sites.

### Example
A vulnerable redirect in PHP:
```php
header("Location: " . $_GET['url']);
```
An attacker could set `url=http://malicious.com`, redirecting users to a phishing site. A secure version validates the URL:
```php
$trusted_urls = ['http://example.com', 'http://sub.example.com'];
if (in_array($_GET['url'], $trusted_urls)) {
    header("Location: " . $_GET['url']);
}
```

### OWASP Mapping
- **OWASP Resource**: Unvalidated Redirects and Forwards Cheat Sheet
- **CWEs**: Not explicitly mapped, but related to CWE-601 (URL Redirection to Untrusted Site).

## Comparison Table of Vulnerabilities

| Vulnerability | OWASP Top 10:2021 Mapping | Key CWEs | Max Incidence Rate | Prevention Strategies |
|---------------|--------------------------|----------|--------------------|-----------------------|
| Injection | A03:2021-Injection | CWE-89, CWE-79 | 19.09% | Parameterized queries, input validation |
| Broken Authentication | A07:2021-Identification and Authentication Failures | CWE-287, CWE-384 | 14.84% | MFA, secure session management |
| Cross-Site Scripting (XSS) | A03:2021-Injection | CWE-79, CWE-80 | Included in Injection | Output encoding, CSP |
| Insecure Direct Object Reference | A01:2021-Broken Access Control | CWE-639 | 55.97% | Access control checks, indirect references |
| Security Misconfiguration | A05:2021-Security Misconfiguration | CWE-16, CWE-611 | 19.84% | Secure configurations, regular audits |
| Sensitive Data Exposure | A02:2021-Cryptographic Failures | CWE-327, CWE-331 | 46.44% | Encryption, access controls |
| Missing Function Level Access Control | A01:2021-Broken Access Control | CWE-862, CWE-863 | 55.97% | Function-level checks, RBAC |
| Cross-Site Request Forgery (CSRF) | Not in Top 10 | CWE-352 | Not specified | CSRF tokens, SameSite cookies |
| Using Components With Known Vulnerabilities | A06:2021-Vulnerable and Outdated Components | CWE-1104 | 27.96% | Regular updates, dependency scanning |
| Unvalidated Redirects and Forwards | Not in Top 10 | CWE-601 | Not specified | URL validation, indirect references |

## Conclusion
The vulnerabilities listed in Unit 2 represent critical risks to web applications, as highlighted by OWASP’s resources. By understanding their causes and implementing prevention strategies, organizations can significantly reduce their attack surface. Regular updates, secure coding practices, and robust access controls are essential to mitigate these threats, fostering a secure digital environment.

## Key Citations
- [OWASP Top Ten 2021](https://owasp.org/Top10/)
- [Cross-Site Request Forgery Prevention Cheat Sheet](https://cheatsheetseries.owasp.org/cheatsheets/Cross-Site_Request_Forgery_Prevention_Cheat_Sheet.html)
- [Unvalidated Redirects and Forwards Cheat Sheet](https://cheatsheetseries.owasp.org/cheatsheets/Unvalidated_Redirects_and_Forwards_Cheat_Sheet.html)
- [OWASP Cross-Site Request Forgery (CSRF)](https://owasp.org/www-community/attacks/csrf)
- [OWASP Top Ten 2025](https://www.owasptopten.org/)
- [What is OWASP? What is the OWASP Top 10?](https://www.cloudflare.com/learning/security/threats/owasp-top-10/)
- [The In-Depth Guide to OWASP Top 10 Vulnerabilities](https://www.jit.io/resources/security-standards/the-in-depth-guide-to-owasps-top-10-vulnerabilities)
- [What Is the OWASP Top 10 and How Does It Work?](https://www.blackduck.com/glossary/what-is-owasp-top-10.html)
- [OWASP Top 10 Vulnerabilities](https://www.veracode.com/security/owasp-top-10)
- [What is OWASP | What are OWASP Top 10 Vulnerabilities](https://www.imperva.com/learn/application-security/owasp-top-10/)
- [OWASP Top 10 for Large Language Model Applications](https://owasp.org/www-project-top-10-for-large-language-model-applications/)
- [Cross-site request forgery (CSRF) prevention](https://developer.mozilla.org/en-US/docs/Web/Security/Practical_implementation_guides/CSRF_prevention)
- [What Is Cross-Site Request Forgery (CSRF)? Impact and Prevention](https://www.brightsec.com/blog/cross-site-request-forgery-csrf/)
- [Cross-Site Request Forgery (CSRF) Examples and Prevention](https://www.wiz.io/academy/cross-site-request-forgery-csrf)
- [CSRF Attack | Tutorial & Examples](https://learn.snyk.io/lesson/csrf-attack/)
- [Cross Site Request Forgery attacks](https://is.docs.wso2.com/en/7.0.0/deploy/mitigate-attacks/mitigate-cross-site-request-forgery-attacks/)
- [Cross-site request forgery](https://en.wikipedia.org/wiki/Cross-site_request_forgery)
- [Cross-site Request Forgery](https://www.invicti.com/web-vulnerability-scanner/vulnerabilities/cross-site-request-forgery/)
- [Unvalidated Redirects and Forwards in OWASP Juice Shop](https://medium.com/%40rohanroshan966/unvalidated-redirects-and-forwards-in-owasp-juice-shop-fcaa79162069)
- [How and Why to Avoid Unvalidated Redirects and Forwards?](https://www.acunetix.com/blog/web-security-zone/unvalidated-redirects-and-forwards/)
- [What are invalidated redirects and forwards in OWASP?](https://www.quora.com/What-are-invalidated-redirects-and-forwards-in-OWASP)
- [OWASP TOP 10 2013: Unvalidated redirects and forwards](https://blog.detectify.com/best-practices/owasp-top-10-unvalidated-redirects-and-forwards-10/)
- [Understanding Unvalidated Redirects and Forwards](https://www.tutorialspoint.com/security_testing/unvalidated_redirects_and_forwards.htm)
- [OWASP A10-Unvalidated Redirects and Forwards](https://gbhackers.com/owasp-a10-unvalidated-redirects-forwards/)
- [Unvalidated Redirects and Forwards](https://www.invicti.com/learn/unvalidated-redirects-and-forwards/)
- [Unvalidated Redirects and Forwards](https://www.geeksforgeeks.org/unvalidated-redirects-and-forwards/)
- [Dynamic Application Security Testing (DAST) with Veracode](https://www.veracode.com/products/dynamic-analysis-dast)

